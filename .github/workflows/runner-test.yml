name: Runner check access to proxmox

on:
  push:
  workflow_dispatch:

jobs:
  test:
    runs-on: self-hosted
    steps:
      - name: Test access to PVE3 API
        run: |
          curl -k -s -X GET "https://pve3:8006/api2/json/nodes/pve3/qemu/8001/config" -H 'Authorization: PVEAPIToken=root@pam!terraformtoken=d3f3b498-18a9-4d87-bc0d-e122124e0107' | jq -r        env:
          PROXMOX_TOKEN_ID: ${{ secrets.PROXMOX_TOKEN_ID }}
          PROXMOX_TOKEN_SECRET: ${{secrets.PROXMOX_TOKEN_SECRET}}

